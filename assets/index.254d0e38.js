const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}};x();let a,D=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});D.decode();let v=null;function I(){return(v===null||v.buffer!==a.memory.buffer)&&(v=new Uint8Array(a.memory.buffer)),v}function F(t,e){return D.decode(I().subarray(t,t+e))}function B(t){return()=>{throw new Error(`${t} is not defined`)}}const W=Object.freeze({Dead:0,"0":"Dead",Alive:1,"1":"Alive"});class _{static __wrap(e){const n=Object.create(_.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();a.__wbg_universe_free(e)}constructor(e,n){var i=a.universe_new(e,n);return _.__wrap(i)}resize(e,n){a.universe_resize(this.ptr,e,n)}toggleCell(e,n){a.universe_toggleCell(this.ptr,e,n)}fillRandom(){a.universe_fillRandom(this.ptr)}reset(){a.universe_reset(this.ptr)}tick(){a.universe_tick(this.ptr)}getIndex(e,n){var i=a.universe_getIndex(this.ptr,e,n);return i>>>0}cells(){var e=a.universe_cells(this.ptr);return e}}async function N(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(i){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}else{const n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}async function E(t){typeof t=="undefined"&&(t=new URL("/wasm-gol/assets/gol-backend_bg.be40689a.wasm",self.location));const e={};e.wbg={},e.wbg.__wbg_random_a582babfa4489c72=typeof Math.random=="function"?Math.random:B("Math.random"),e.wbg.__wbindgen_throw=function(r,o){throw new Error(F(r,o))},(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:i}=await N(await t,e);return a=n.exports,E.__wbindgen_wasm_module=i,a}const c=10,P="#000",z="#fff";async function U(){const{memory:t}=await E(),e=document.querySelector("#toggle"),n=document.querySelector("#step"),i=document.querySelector("#reset"),r=document.querySelector("#random"),o=document.querySelector("#resize"),h=document.querySelector("#width"),q=document.querySelector("#height"),l=document.querySelector("#gol-canvas"),A=l.getContext("2d");let u=h.valueAsNumber,f=q.valueAsNumber;l.width=(c+1)*u+1,l.height=(c+1)*f+1;const m=new _(u,f),g=()=>{const s=m.cells(),y=new Uint8Array(t.buffer,s,u*f);A.beginPath();for(let p=0;p<f;p++)for(let w=0;w<u;w++){const L=m.getIndex(w,p);A.fillStyle=y[L]===W.Dead?P:z,A.fillRect(w*(c+1)+1,p*(c+1)+1,c,c)}};let d=null;const R=()=>{m.tick(),g()},S=()=>{R(),d=requestAnimationFrame(S)},C=()=>{e.textContent="Pause",d=requestAnimationFrame(S)},b=()=>{d&&(cancelAnimationFrame(d),d=null),e.textContent="Play"};e.addEventListener("click",s=>{s.preventDefault(),d?b():C()}),n.addEventListener("click",s=>{s.preventDefault(),b(),requestAnimationFrame(R)}),i.addEventListener("click",s=>{s.preventDefault(),b(),m.reset(),d===null&&requestAnimationFrame(g)}),r.addEventListener("click",s=>{s.preventDefault(),m.fillRandom(),d===null&&requestAnimationFrame(g)}),o.addEventListener("click",s=>{s.preventDefault(),b(),u=h.valueAsNumber,f=q.valueAsNumber,l.width=(c+1)*u+1,l.height=(c+1)*f+1,m.resize(u,f),g()}),l.addEventListener("click",s=>{s.preventDefault();const y=l.getBoundingClientRect(),p=l.width/y.width,w=l.height/y.height,L=(s.clientX-y.left)*p,M=(s.clientY-y.top)*w,O=Math.min(Math.floor(L/(c+1)),u-1),k=Math.min(Math.floor(M/(c+1)),f-1);m.toggleCell(O,k),requestAnimationFrame(g)}),g()}U();
